(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{149:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return c})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return o})),a.d(t,"default",(function(){return b}));var n=a(2),r=a(9),i=(a(0),a(154)),c={id:"search",title:"Search"},s={id:"search",isDocsHomePage:!1,title:"Search",description:"Overview",source:"@site/docs/search.md",permalink:"/docs/search",editUrl:"https://github.com/winget-run/docs/tree/master/docs/search.md",sidebar:"packageApi",previous:{title:"Packages",permalink:"/docs/packages"},next:{title:"Stats",permalink:"/docs/stats"}},o=[{value:"Overview",id:"overview",children:[{value:"Multiple fields",id:"multiple-fields",children:[]},{value:"Fuzzy search",id:"fuzzy-search",children:[]},{value:"Additional options",id:"additional-options",children:[]}]},{value:"Schema",id:"schema",children:[]},{value:"Routes",id:"routes",children:[{value:"Package search",id:"package-search",children:[]}]}],l={rightToc:o};function b(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"overview"},"Overview"),Object(i.b)("p",null,"This part of the guide explains how package search related routes function and the best practices surrounding them. We have decided to separate search related content from packages as these routes have added complexity which needs to be focused on and explained to allow developers to make the best use of them."),Object(i.b)("h3",{id:"multiple-fields"},"Multiple fields"),Object(i.b)("p",null,"Our search algorithm uses MongoDB text search and examines multiple fields with a weighted score for each field in order to determine the most suitable results. While multiple results can be returned with the same score can be returned in the 'package search' rotue, these results are further filtered and sorted using extra query parameters."),Object(i.b)("p",null,"Search fields:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Name"),Object(i.b)("li",{parentName:"ul"},"Publisher"),Object(i.b)("li",{parentName:"ul"},"Tags"),Object(i.b)("li",{parentName:"ul"},"Description")),Object(i.b)("p",null,"While the first three fields are fully included in the search, as some descriptions can be lengthy, keywords are extracted and used for the search instead."),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"Details including keyword extraction are not yet finalised."))),Object(i.b)("h3",{id:"fuzzy-search"},"Fuzzy search"),Object(i.b)("p",null,"In order to provide the most accurate results, we use fuzzy search. This means that users can not only search for exact matches, but partial words and phrases. In addition, similar sounding words are considered eqivalent in our search algorithm, such as colour and color. We achieve this internally through the combination of ngrams and the double metaphone algorithm."),Object(i.b)("h3",{id:"additional-options"},"Additional options"),Object(i.b)("p",null,"Multiple additional options can be specified for our search algorithm through the use of query parameters which will affect the searching and filtering of results. These may be available or one or more search routes below."),Object(i.b)("h4",{id:"query"},"Query"),Object(i.b)("p",null,"This is a 'search all fields' type query. Setting this parameter will disallow the following:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"name"),Object(i.b)("li",{parentName:"ul"},"publisher"),Object(i.b)("li",{parentName:"ul"},"description"),Object(i.b)("li",{parentName:"ul"},"tags")),Object(i.b)("h4",{id:"namepublisherdescription"},"Name/Publisher/Description"),Object(i.b)("p",null,"These parameters allow for searching by a specific field and can be combined."),Object(i.b)("h4",{id:"tags"},"Tags"),Object(i.b)("p",null,"This parameter allows for searching for package tags. Multiple tags can be specified by separating them by a ','."),Object(i.b)("h4",{id:"split-query"},"Split query"),Object(i.b)("p",null,"Default: true."),Object(i.b)("p",null,"This option splits the search query by whitespace and searched for each part separately."),Object(i.b)("h4",{id:"partial-match"},"Partial match"),Object(i.b)("p",null,"Default: false."),Object(i.b)("p",null,"This option enabled the 'partial' part of fuzzy search; The query string will be split into ngrams which will be used for the search. This process is carried our on each part of the query if 'split query' is enabled."),Object(i.b)("h4",{id:"ensure-contains"},"Ensure contains"),Object(i.b)("p",null,"Default: false."),Object(i.b)("p",null,"This option ensures that each final search result exactly contains the specified query, discarding non-matching results. Additionally, this option cannot be set if a non 'query' search paramter such as name, publisher, etc. is specified."),Object(i.b)("h4",{id:"prefer-contains"},"Prefer contains"),Object(i.b)("p",null,"Default: false."),Object(i.b)("p",null,"This option functions similarly to 'ensure contains', however, instead of removing packages which don't exactly match the search query, results are re-shuffled based on how well they match the query."),Object(i.b)("h4",{id:"sample"},"Sample"),Object(i.b)("p",null,"Default: take (see ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/introduction#pagination"}),"pagination"),")."),Object(i.b)("p",null,"The number of packages to sample when 'prefer contains' is specified. This option exists in case packages outside of the number specified by 'take' could be a higher match. While the sorting logic will use 'sample' packages, only 'take' packages will be returned in the final response."),Object(i.b)("div",{className:"admonition admonition-caution alert alert--warning"},Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-heading"}),Object(i.b)("h5",{parentName:"div"},Object(i.b)("span",Object(n.a)({parentName:"h5"},{className:"admonition-icon"}),Object(i.b)("svg",Object(n.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"}),Object(i.b)("path",Object(n.a)({parentName:"svg"},{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})))),"caution")),Object(i.b)("div",Object(n.a)({parentName:"div"},{className:"admonition-content"}),Object(i.b)("p",{parentName:"div"},"When setting this to any value other than 'take', pagination will no longer work correctly. As such, this should be used for sampling a small number of top results, for example, for an autocomplete search."))),Object(i.b)("h2",{id:"schema"},"Schema"),Object(i.b)("p",null,"This route returns 'package' responses with an extra added 'SearchScore' field. For more info about the this schema, please read the package routes section."),Object(i.b)("p",null,"Package (with SearchScore)"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"Id: string;\n\nVersions: string[];\nLatest: {\n  Name: string;\n  Publisher: string;\n  Tags: string[];\n  Description?: string;\n  Homepage?: string;\n  License?: string;\n  LicenseUrl?: string;\n};\n\nFeatured: boolean;\nIconUrl?: string;\nBanner?: string;\nLogo?: string;\n\nUpdatedAt: Date;\nCreatedAt: Date;\n\nSearchScore: number;\n")),Object(i.b)("h2",{id:"routes"},"Routes"),Object(i.b)("p",null,"Package search related routes are outlined below:"),Object(i.b)("h3",{id:"package-search"},"Package search"),Object(i.b)("p",null,"This route can be used to search for packages. It should be used for viewing large amounts for search results."),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"This route returns paginated results.")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Allowed sort fields: SearchScore (default), Latest.Name, Latest.Publisher, UpdatedAt.")),Object(i.b)("h4",{id:"url"},"Url"),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"/v2/packages")),Object(i.b)("h4",{id:"query-1"},"Query"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"query: string\nname: string\npublisher: string\ndescription: string\ntags: string\nsplitQuery: boolean\npartialMatch: boolean\nensureContains: boolean\npreferContains: boolean\nsample: number\n")),Object(i.b)("h4",{id:"successful-response"},"Successful response"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"Code: 200\nBody:\n  Packages: Package[] (with SearchScore)\n  Total: number\n")),Object(i.b)("h4",{id:"no-data-response"},"No data response"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"Code: 200\nBody:\n  Packages: []\n  Total: 0\n")))}b.isMDXComponent=!0},154:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=r.a.createContext({}),b=function(e){var t=r.a.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},u=function(e){var t=b(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},h=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,c=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),u=b(a),h=n,d=u["".concat(c,".").concat(h)]||u[h]||p[h]||i;return a?r.a.createElement(d,s(s({ref:t},l),{},{components:a})):r.a.createElement(d,s({ref:t},l))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,c=new Array(i);c[0]=h;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:n,c[1]=s;for(var l=2;l<i;l++)c[l]=a[l];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,a)}h.displayName="MDXCreateElement"}}]);